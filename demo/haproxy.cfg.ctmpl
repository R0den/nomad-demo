global
    maxconn 4

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

listen front-in
    bind *:8000
    balance roundrobin{{range service "demo-service"}}
    server {{.Node}} {{.Address}}:{{.Port}} weight 1 maxconn 512 check{{end}}

listen search-in
    bind *:9000
    balance roundrobin{{range service "demo-storage"}}
    server {{.Node}} {{.Address}}:{{.Port}} weight 1 maxconn 512 check{{end}}
